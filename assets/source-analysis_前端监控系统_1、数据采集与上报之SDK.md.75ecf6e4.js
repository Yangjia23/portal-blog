import{o as n,c as a,a as s,b as t}from"./app.5a70c45b.js";const o='{"title":"一、前端监控系统","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、前端监控系统","slug":"一、前端监控系统"},{"level":2,"title":"二、SDK 核心功能","slug":"二、sdk-核心功能"},{"level":3,"title":"2.1、自动上报数据","slug":"_2-1、自动上报数据"},{"level":3,"title":"2.2、手动上报数据","slug":"_2-2、手动上报数据"},{"level":3,"title":"2.3、何时上报以及如何上报","slug":"_2-3、何时上报以及如何上报"},{"level":2,"title":"三、总结","slug":"三、总结"}],"relativePath":"source-analysis/前端监控系统/1、数据采集与上报之SDK.md","lastUpdated":1635300599249}',e={},l=[s("p",null,"前端团队 Q4 阶段需要开发一个前端监控系统，有些小伙伴可能并不太清楚其相关内容，本专题会介绍其出现的原因、工作原理等，本文会重点介绍监控系统中的 SDK 核心功能，包括数据采集、自动上报、手动上报等",-1),s("h2",{id:"一、前端监控系统"},[s("a",{class:"header-anchor",href:"#一、前端监控系统","aria-hidden":"true"},"#"),t(" 一、前端监控系统")],-1),s("p",null,"在开发之前，我们需要了解我们为什么需要前端监控系统，它将会帮助我们解决什么问题？",-1),s("ul",null,[s("li",null,"保存记录线上 bug 出现的现场环节，利用 Bug 堆栈信息来定位 bug"),s("li",null,"统计分析用户所使用的系统分布、浏览器分布、设备分布等，找出我们的主要用户"),s("li",null,"统计前端优化前后的页面性能来判断某次性能优化方案是否成功"),s("li",null,"统计用户访问量、在线时长，以及业务模块的使用情况，为产品后续发展提供参考")],-1),s("p",null,[t("监控系统可以做的还有很多，而最主要的就是 “"),s("strong",null,"比用户更早发现问题，在用户发现问题之前解决问题"),t('"')],-1),s("h2",{id:"二、sdk-核心功能"},[s("a",{class:"header-anchor",href:"#二、sdk-核心功能","aria-hidden":"true"},"#"),t(" 二、SDK 核心功能")],-1),s("p",null,[s("img",{src:"/portal-blog/images/sdk/framework.png",alt:"linear.png"})],-1),s("h3",{id:"_2-1、自动上报数据"},[s("a",{class:"header-anchor",href:"#_2-1、自动上报数据","aria-hidden":"true"},"#"),t(" 2.1、自动上报数据")],-1),s("p",null,"自动上报的数据不会破坏业务逻辑代码，只需要引入 SDK 即可",-1),s("h4",{id:"_2-1-1、错误类型数据"},[s("a",{class:"header-anchor",href:"#_2-1-1、错误类型数据","aria-hidden":"true"},"#"),t(" 2.1.1、错误类型数据")],-1),s("p",null,"错误类型数据指的是运行过程中的前端报错，如 JS 语法错误、JS 解析报错、Vue 和 React 等常见框架的报错等，而每个错误对象都是 JS 中 Error 这个构造函数的实例，其具有 messgae 和 stack 两个属性",-1),s("p",null,"所以的报错可归纳成以下几种",-1),s("ul",null,[s("li",null,[s("p",null,"SyntaxError: 语法错误"),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token keyword"},"function"),t(),s("span",{class:"token function"},"fn"),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token keyword"},"var"),t(" a "),s("span",{class:"token operator"},"="),t("\n"),s("span",{class:"token punctuation"},"}"),t("\n"),s("span",{class:"token function"},"fn"),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),t("\n")])])]),s("p",null,"SyntaxError（语法错误）发生在代码解析过程中，一般在开发阶段就会发现")]),s("li",null,[s("p",null,"TypeError: 类型错误"),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token keyword"},"let"),t(" a "),s("span",{class:"token operator"},"="),t(),s("span",{class:"token number"},"123"),t("\na"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"push"),s("span",{class:"token punctuation"},"("),s("span",{class:"token number"},"5"),s("span",{class:"token punctuation"},")"),t("\n")])])]),s("p",null,"TypeError (类型错误) 是变量不是预期的类型时发生错误")]),s("li",null,[s("p",null,"RangeError: 范围错误"),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token keyword"},"let"),t(" a "),s("span",{class:"token operator"},"="),t(),s("span",{class:"token keyword"},"new"),t(),s("span",{class:"token class-name"},"Array"),s("span",{class:"token punctuation"},"("),s("span",{class:"token operator"},"-"),s("span",{class:"token number"},"1"),s("span",{class:"token punctuation"},")"),t("\n")])])]),s("p",null,"RangeError (范围错误) 是一个值超过了有效的范围时发生错误")]),s("li",null,[s("p",null,"ReferenceError: 引用错误"),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[t("console"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"log"),s("span",{class:"token punctuation"},"("),t("aaa"),s("span",{class:"token punctuation"},")"),t("\n")])])]),s("p",null,"ReferenceError (引用错误) 是引用一个不存在的变量时发生错误")])],-1),s("ul",null,[s("li",null,[s("p",null,"Failed to load resource: 资源加载错误"),s("p",null,"资源加载错误是指以下标签加载资源出错时发生错误"),s("div",{class:"language-"},[s("pre",null,[s("code",null,'<img>, <input type="image">, <object>, <script>, <style>, <audio>, <video>\n')])])])],-1),s("p",null,[t("如何收集报错信息，有两种方案: 通过 "),s("code",null,"try...catch..."),t(" 捕获，以及 "),s("code",null,"window.onerror"),t(" 监听")],-1),s("ul",null,[s("li",null,[s("p",null,[s("code",null,"try...catch..."),t(" 方案")]),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token keyword"},"try"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token comment"},"// 代码"),t("\n"),s("span",{class:"token punctuation"},"}"),t(),s("span",{class:"token keyword"},"catch"),t(),s("span",{class:"token punctuation"},"("),t("e"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token comment"},"// 错误处理"),t("\n  "),s("span",{class:"token comment"},"// 上报错误"),t("\n"),s("span",{class:"token punctuation"},"}"),t("\n")])])]),s("p",null,[t("通过自动化工具可对每个函数添加 try catch, 对错误进行"),s("strong",null,"兜底处理"),t("，但也存在局限性")]),s("ul",null,[s("li",null,"无法处理语法错误和异步错误")]),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token comment"},"// 下面两种报错信息，try...catch 都无法捕获"),t("\n"),s("span",{class:"token keyword"},"try"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token keyword"},"let"),t(" a "),s("span",{class:"token operator"},"="),t("\\ "),s("span",{class:"token string"},"'a'"),t("\n"),s("span",{class:"token punctuation"},"}"),t(),s("span",{class:"token keyword"},"catch"),s("span",{class:"token punctuation"},"("),t("e"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"{"),t("\n  console"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"log"),s("span",{class:"token punctuation"},"("),t("e"),s("span",{class:"token punctuation"},")"),t("\n"),s("span",{class:"token punctuation"},"}"),t("\n\n"),s("span",{class:"token keyword"},"try"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token function"},"setTimeout"),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token operator"},"=>"),t(),s("span",{class:"token punctuation"},"{"),t("\n    a\n  "),s("span",{class:"token punctuation"},"}"),s("span",{class:"token punctuation"},")"),t("\n"),s("span",{class:"token punctuation"},"}"),t(),s("span",{class:"token keyword"},"catch"),s("span",{class:"token punctuation"},"("),t("e"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"{"),t("\n  console"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"log"),s("span",{class:"token punctuation"},"("),t("e"),s("span",{class:"token punctuation"},")"),t("\n"),s("span",{class:"token punctuation"},"}"),t("\n")])])]),s("ul",null,[s("li",null,"对代码的侵入性较强")])]),s("li",null,[s("p",null,[s("code",null,"window.onerror"),t(" 方案")]),s("p",null,[t("使用 "),s("code",null,"window.onerror"),t(" 监听也存在局限性，因为 "),s("code",null,"window.onerror"),t(" 是通过"),s("strong",null,"事件冒泡"),t("获取 error 信息，而网络资源加载错误是不会进行冒泡的，而 "),s("code",null,"window.addEventListener"),t(" 是通过"),s("strong",null,"事件捕获"),t("获取 error 信息的，")]),s("p",null,[t("同时 "),s("code",null,"window.onerror"),t(" 可以通过赋值进行覆盖掉，而 "),s("code",null,"addEventListener"),t(" 可以绑定多个回调，所以最终使用 "),s("code",null,"addEventListener"),t(" 统一对 JS 错误和资源加载错误进行收集")]),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[t("window"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"addEventListener"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},"'error'"),s("span",{class:"token punctuation"},","),t(" handlerError"),s("span",{class:"token punctuation"},","),t(),s("span",{class:"token boolean"},"true"),s("span",{class:"token punctuation"},")"),t("\n")])])])])],-1),s("p",null,[t("除了上面的报错，我们还需要捕获未处理的 "),s("code",null,"Promise"),t(" 错误，可通过绑定 "),s("code",null,"unhandledrejection"),t(" 事件来监听")],-1),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[t("window"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"addEventListener"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},"'unhandledrejection'"),s("span",{class:"token punctuation"},","),t(" handlerError"),s("span",{class:"token punctuation"},","),t(),s("span",{class:"token boolean"},"true"),s("span",{class:"token punctuation"},")"),t("\n")])])],-1),s("p",null,[t("而针对于 React 和 Vue 框架中的保持，以 Vue 为例，官方提供"),s("code",null,"Vue.config.errorHandler"),t(" 来处理捕获的错误，如何开发者没配置，捕获的错误会以 "),s("code",null,"console.error"),t(" 的方式输出，所以可以劫持 "),s("code",null,"console.error"),t(" 来捕获框架中的错误")],-1),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[t("console"),s("span",{class:"token punctuation"},"."),t("error "),s("span",{class:"token operator"},"="),t(),s("span",{class:"token punctuation"},"("),s("span",{class:"token keyword"},"function"),s("span",{class:"token punctuation"},"("),s("span",{class:"token parameter"},"origin"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token keyword"},"return"),t(),s("span",{class:"token keyword"},"function"),s("span",{class:"token punctuation"},"("),s("span",{class:"token parameter"},"info"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token punctuation"},"{"),t("\n    "),s("span",{class:"token keyword"},"var"),t(" errorLog "),s("span",{class:"token operator"},"="),t(),s("span",{class:"token punctuation"},"{"),t("\n      type"),s("span",{class:"token operator"},":"),t(),s("span",{class:"token string"},"'xxx'"),s("span",{class:"token punctuation"},","),t("\n      desc"),s("span",{class:"token operator"},":"),t(" info"),s("span",{class:"token punctuation"},","),t("\n    "),s("span",{class:"token punctuation"},"}"),t("\n    "),s("span",{class:"token function"},"handlerError"),s("span",{class:"token punctuation"},"("),t("errorLog"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token comment"},"// 进行上报"),t("\n    "),s("span",{class:"token function"},"origin"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"call"),s("span",{class:"token punctuation"},"("),t("console"),s("span",{class:"token punctuation"},","),t(" info"),s("span",{class:"token punctuation"},")"),t("\n  "),s("span",{class:"token punctuation"},"}"),t("\n"),s("span",{class:"token punctuation"},"}"),s("span",{class:"token punctuation"},")"),s("span",{class:"token punctuation"},"("),t("console"),s("span",{class:"token punctuation"},"."),t("error"),s("span",{class:"token punctuation"},")"),t("\n")])])],-1),s("h4",{id:"_2-1-2、性能相关数据"},[s("a",{class:"header-anchor",href:"#_2-1-2、性能相关数据","aria-hidden":"true"},"#"),t(" 2.1.2、性能相关数据")],-1),s("p",null,"性能监控常用指标",-1),s("ul",null,[s("li",null,"首次绘制时间（FP）：页面发生第一次绘制的时间点"),s("li",null,"首次有内容绘制时间（FCP）：浏览器完成渲染 DOM 中第一部分内容的时间点"),s("li",null,"首次有意义绘制时间（FMP）：页面关键元素的渲染时间，何为“关键元素”可自行定义"),s("li",null,"首屏时间：进入页面之后，应用渲染完成整个屏幕(未滚动)内容的时间"),s("li",null,[t("用户可交互时间：通常指 "),s("code",null,"DOMReady"),t(" 时间")]),s("li",null,[t("总下载时间: 可统计称 "),s("code",null,"window.onload"),t(" 时间")])],-1),s("p",null,[t("以上指标可在浏览器控制台中通过 "),s("code",null,"Lighthouse"),t(" 进行分析得出,也可通过 "),s("a",{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/PerformanceObserver",target:"_blank",rel:"noopener noreferrer"},"PerformanceObserver"),t(" 来获取, 具体代码可参考 "),s("a",{href:"https://juejin.cn/post/7017974567943536671#heading-1",target:"_blank",rel:"noopener noreferrer"},"SDK-性能数据采集")],-1),s("p",null,"性能数据获取",-1),s("ul",null,[s("li",null,[s("code",null,"window.preformance"),t("：强大有缺点")])],-1),s("p",null,[s("code",null,"window.preformance.timing"),t(" 会返回一个对象，包含页面加载和渲染的各个时间节点")],-1),s("p",null,[s("img",{src:"/portal-blog/images/sdk/timing.png",alt:"linear.png"})],-1),s("p",null,"而根据这些时间节点选择相对于的两个做差值，即可计算出一些典型指标",-1),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token keyword"},"const"),t(),s("span",{class:"token function-variable function"},"calcTime"),t(),s("span",{class:"token operator"},"="),t(),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token operator"},"=>"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token keyword"},"let"),t(" times "),s("span",{class:"token operator"},"="),t(),s("span",{class:"token punctuation"},"{"),s("span",{class:"token punctuation"},"}"),t("\n  "),s("span",{class:"token keyword"},"let"),t(" t "),s("span",{class:"token operator"},"="),t(" window"),s("span",{class:"token punctuation"},"."),t("preformance"),s("span",{class:"token punctuation"},"."),t("timing\n\n  "),s("span",{class:"token comment"},"// 重定向时间"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("redirectTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("redirectEnd "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("redirectStart\n  "),s("span",{class:"token comment"},"// DNS 查询耗时"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("dnsTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("domainLookupEnd "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("domainLookupStart\n  "),s("span",{class:"token comment"},"// TCP 连接耗时"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("tcpTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("connectEnd "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("connectStart\n  "),s("span",{class:"token comment"},"// request 请求耗时"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("reqTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("responseStart "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("requestStart\n  "),s("span",{class:"token comment"},"// response 响应耗时"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("resTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("responseEnd "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("responseStart\n  "),s("span",{class:"token comment"},"// 解析 DOM 树耗时"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("analysisTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("domComplete "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("domInteractive\n  "),s("span",{class:"token comment"},"// 白屏时间"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("blackTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("domLoading "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("fetchStart\n  "),s("span",{class:"token comment"},"// 用户可交互时间"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("domReadyTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("domContentLoadedEventEnd "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("fetchStart\n  "),s("span",{class:"token comment"},"// 页面完全可用时间"),t("\n  times"),s("span",{class:"token punctuation"},"."),t("loadPageTime "),s("span",{class:"token operator"},"="),t(" t"),s("span",{class:"token punctuation"},"."),t("loadEventEnd "),s("span",{class:"token operator"},"-"),t(" t"),s("span",{class:"token punctuation"},"."),t("navigationStart\n\n  "),s("span",{class:"token keyword"},"return"),t(" times\n"),s("span",{class:"token punctuation"},"}"),t("\n")])])],-1),s("p",null,"局限性",-1),s("p",null,[t("单页应用改变 URL 但不刷新页面，导致 "),s("code",null,"window.preformance"),t(" 所获取的数据不会更新")],-1),s("ul",null,[s("li",null,"自定义时间计算")],-1),s("div",{class:"language-"},[s("pre",null,[s("code",null,"// [todo]\n")])],-1),s("h3",{id:"_2-2、手动上报数据"},[s("a",{class:"header-anchor",href:"#_2-2、手动上报数据","aria-hidden":"true"},"#"),t(" 2.2、手动上报数据")],-1),s("p",null,"手动上报数据适合用户行为收集、自定义错误收集等场景，只需要将手动上报数据的方法暴露出去即可",-1),s("h3",{id:"_2-3、何时上报以及如何上报"},[s("a",{class:"header-anchor",href:"#_2-3、何时上报以及如何上报","aria-hidden":"true"},"#"),t(" 2.3、何时上报以及如何上报")],-1),s("p",null,"对应报错和异常数据的上报，当日志量很大，就有必要将日志合并，在同一时间进行上报。",-1),s("p",null,"而对于页面性能数据，在以下场景下可以上报",-1),s("ul",null,[s("li",null,"页面加载和重新刷新"),s("li",null,"页面切换路由"),s("li",null,"页面所在的 Tab 标签重新变得可见"),s("li",null,"页面关闭")],-1),s("p",null,[t("对于单页应用，如果是 hash 模式，可监听 "),s("code",null,"hashchange"),t(" 事件, 如果是 "),s("code",null,"history"),t(" 模式，则需要重写 "),s("code",null,"history.pushState"),t(" 和 "),s("code",null,"history.replaceState"),t(" 方法")],-1),s("p",null,[t("对于非单页应用，可在页面离开的时候上报数据，监听 "),s("code",null,"unload"),t(" 事件并使用 "),s("code",null,"navigation.sendBeacon"),t(" 方法保障数据发送")],-1),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[t("window"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"addEventListener"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},"'unload'"),s("span",{class:"token punctuation"},","),t(" logData"),s("span",{class:"token punctuation"},","),t(),s("span",{class:"token boolean"},"false"),s("span",{class:"token punctuation"},")"),t("\n"),s("span",{class:"token keyword"},"const"),t(),s("span",{class:"token function-variable function"},"logData"),t(),s("span",{class:"token operator"},"="),t(),s("span",{class:"token punctuation"},"("),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token operator"},"=>"),t(),s("span",{class:"token punctuation"},"{"),t("\n  navigation"),s("span",{class:"token punctuation"},"."),s("span",{class:"token function"},"sendBeacon"),s("span",{class:"token punctuation"},"("),s("span",{class:"token string"},"'/log'"),s("span",{class:"token punctuation"},","),t(" data"),s("span",{class:"token punctuation"},")"),t("\n"),s("span",{class:"token punctuation"},"}"),t("\n")])])],-1),s("p",null,[s("code",null,"sendBeacon"),t(" 方法相比于直接发送 Ajax 请求，有以下优势")],-1),s("ul",null,[s("li",null,"它是异步的，请求的发送不会阻塞跳转到下一个页面"),s("li",null,"它在没有极限数据量和队列总数的现在下，会优先返回 true 以保障请求成功发送")],-1),s("p",null,"除了发送请求，还可以通过动态创建 img 标签，将数据拼接到 URL 上进行上报，不存在跨域限制，但 URL 有长度限制",-1),s("p",null,"所以可以对 URL 进行判断，使用不同上报方式",-1),s("div",{class:"language-js"},[s("pre",null,[s("code",null,[s("span",{class:"token keyword"},"const"),t(),s("span",{class:"token function-variable function"},"reportLog"),t(),s("span",{class:"token operator"},"="),t(),s("span",{class:"token punctuation"},"("),s("span",{class:"token parameter"},"url"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token operator"},"=>"),t(),s("span",{class:"token punctuation"},"{"),t("\n  "),s("span",{class:"token comment"},"// ..."),t("\n  "),s("span",{class:"token keyword"},"if"),t(),s("span",{class:"token punctuation"},"("),t("urlLen "),s("span",{class:"token operator"},"<"),t(),s("span",{class:"token number"},"2083"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token punctuation"},"{"),t("\n    "),s("span",{class:"token function"},"imgReport"),s("span",{class:"token punctuation"},"("),t("url"),s("span",{class:"token punctuation"},","),t(" times"),s("span",{class:"token punctuation"},")"),t("\n  "),s("span",{class:"token punctuation"},"}"),t(),s("span",{class:"token keyword"},"else"),t(),s("span",{class:"token keyword"},"if"),t(),s("span",{class:"token punctuation"},"("),t("navigation"),s("span",{class:"token punctuation"},"."),t("sendBeacon"),s("span",{class:"token punctuation"},")"),t(),s("span",{class:"token punctuation"},"{"),t("\n    "),s("span",{class:"token function"},"sendBeacon"),s("span",{class:"token punctuation"},"("),t("url"),s("span",{class:"token punctuation"},","),t(" times"),s("span",{class:"token punctuation"},")"),t("\n  "),s("span",{class:"token punctuation"},"}"),t(),s("span",{class:"token keyword"},"else"),t(),s("span",{class:"token punctuation"},"{"),t("\n    "),s("span",{class:"token function"},"xmlReport"),s("span",{class:"token punctuation"},"("),t("url"),s("span",{class:"token punctuation"},","),t(" times"),s("span",{class:"token punctuation"},")"),t("\n  "),s("span",{class:"token punctuation"},"}"),t("\n"),s("span",{class:"token punctuation"},"}"),t("\n")])])],-1),s("h2",{id:"三、总结"},[s("a",{class:"header-anchor",href:"#三、总结","aria-hidden":"true"},"#"),t(" 三、总结")],-1),s("p",null,[t("SDK 除了上面介绍的数据采集和上报功能后，还需要提供通过"),s("strong",null,"配置"),t("可开启或关闭某个指标的日志是否进行上报")],-1),s("p",null,"参考资料",-1),s("ul",null,[s("li",null,[s("a",{href:"https://zhuanlan.zhihu.com/p/95384915",target:"_blank",rel:"noopener noreferrer"},"从零开始搭建前端监控 - 陈辰")]),s("li",null,[s("a",{href:"https://juejin.cn/post/7017974567943536671#heading-13",target:"_blank",rel:"noopener noreferrer"},"前端监控 SDK 的一些技术要点原理分析")]),s("li",null,[s("a",{href:"https://item.jd.com/10022900825335.html",target:"_blank",rel:"noopener noreferrer"},"性能监控和错误收集与上报")])],-1)];e.render=function(s,t,o,e,c,p){return n(),a("div",null,l)};export{o as __pageData,e as default};
